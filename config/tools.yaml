version: "1.0"
tools:
  - id: filesystem
    name: Filesystem Server
    description: MCP filesystem access
    command: npx
    args: ["-y", "@modelcontextprotocol/server-filesystem", "${DATA_DIR}"]
    resource_limits:
      auto_restart: true
      max_restarts: 3

  - id: core-memory-bridge
    name: Core Memory Bridge
    command: npx
    args:
      - ts-node
      - ${DATA_DIR}/src/core-bridge.ts
    env:
      CORE_API_KEY: ${CORE_API_KEY}
    resource_limits:
      auto_restart: true
      max_restarts: 5
      max_memory_mb: 512

  # ESL Extraction Pipeline Tools
  - id: extraction-phase1
    name: Phase 1 Diagnostic (Kimi)
    description: Run Phase 1 diagnostic analysis on transcript
    command: node
    args:
      - ${DATA_DIR}/src/extraction/phase1.js
    env:
      MOONSHOT_API_KEY: ${MOONSHOT_API_KEY}
    resource_limits:
      auto_restart: false
      max_restarts: 0
      max_memory_mb: 1024

  - id: extraction-phase2
    name: Phase 2 Extraction (Kimi)
    description: Run Phase 2 content extraction
    command: node
    args:
      - ${DATA_DIR}/src/extraction/phase2.js
    env:
      MOONSHOT_API_KEY: ${MOONSHOT_API_KEY}
    resource_limits:
      auto_restart: false
      max_restarts: 0
      max_memory_mb: 1024

  - id: extraction-phase3
    name: Phase 3 Synthesis (Claude)
    description: Run Phase 3 synthesis with Claude
    command: node
    args:
      - ${DATA_DIR}/src/extraction/phase3.js
    env:
      OPENROUTER_API_KEY: ${OPENROUTER_API_KEY}
    resource_limits:
      auto_restart: false
      max_restarts: 0
      max_memory_mb: 2048
